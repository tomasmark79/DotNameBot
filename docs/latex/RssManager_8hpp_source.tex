\doxysection{Rss\+Manager.\+hpp}
\hypertarget{RssManager_8hpp_source}{}\label{RssManager_8hpp_source}\index{src/Rss/RssManager.hpp@{src/Rss/RssManager.hpp}}
\mbox{\hyperlink{RssManager_8hpp}{Go to the documentation of this file.}}
\begin{DoxyCode}{0}
\DoxyCodeLine{00001\ \textcolor{preprocessor}{\#pragma\ once}}
\DoxyCodeLine{00002\ }
\DoxyCodeLine{00003\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{IRssService_8hpp}{Rss/IRssService.hpp}}>}}
\DoxyCodeLine{00004\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{RSSFeed_8hpp}{Rss/RSSFeed.hpp}}>}}
\DoxyCodeLine{00005\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{RSSItem_8hpp}{Rss/RSSItem.hpp}}>}}
\DoxyCodeLine{00006\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{RSSUrl_8hpp}{Rss/RSSUrl.hpp}}>}}
\DoxyCodeLine{00007\ }
\DoxyCodeLine{00008\ \textcolor{preprocessor}{\#include\ <\mbox{\hyperlink{UtilsFactory_8hpp}{Utils/UtilsFactory.hpp}}>}}
\DoxyCodeLine{00009\ }
\DoxyCodeLine{00010\ \textcolor{preprocessor}{\#include\ <filesystem>}}
\DoxyCodeLine{00011\ \textcolor{preprocessor}{\#include\ <nlohmann/json.hpp>}}
\DoxyCodeLine{00012\ \textcolor{preprocessor}{\#include\ <random>}}
\DoxyCodeLine{00013\ \textcolor{preprocessor}{\#include\ <string>}}
\DoxyCodeLine{00014\ \textcolor{preprocessor}{\#include\ <tinyxml2.h>}}
\DoxyCodeLine{00015\ \textcolor{preprocessor}{\#include\ <unordered\_set>}}
\DoxyCodeLine{00016\ \textcolor{preprocessor}{\#include\ <vector>}}
\DoxyCodeLine{00017\ }
\DoxyCodeLine{00018\ \textcolor{keyword}{namespace\ }\mbox{\hyperlink{namespacedotnamecpp_1_1rss}{dotnamecpp::rss}}\ \{}
\DoxyCodeLine{00019\ }
\DoxyCodeLine{00020\ \ \ \textcolor{keyword}{class\ }\mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a5f5b4ce3b332db46fbe72e3a6a6e7e42}{RssManager}}\ :\ \textcolor{keyword}{public}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1IRssService}{IRssService}}\ \{}
\DoxyCodeLine{00021\ }
\DoxyCodeLine{00022\ \ \ \textcolor{keyword}{public}:}
\DoxyCodeLine{00023\ \ \ \ \ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a5f5b4ce3b332db46fbe72e3a6a6e7e42}{RssManager}}(std::shared\_ptr<dotnamecpp::logging::ILogger>\ logger,}
\DoxyCodeLine{00024\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::shared\_ptr<dotnamecpp::assets::IAssetManager>\ assetManager);}
\DoxyCodeLine{00025\ }
\DoxyCodeLine{00026\ \ \ \ \ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a3bdbebb89328a5be2b50dc09c75ff5e5}{\string~RssManager}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00027\ }
\DoxyCodeLine{00028\ \ \ \ \ \textcolor{comment}{//\ Public\ interface\ implementations}}
\DoxyCodeLine{00029\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a5a02da7f6aeeca7bdce38080836dd676}{Initialize}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00030\ \ \ \ \ \textcolor{keywordtype}{int}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a3ed7b353fa2518f1b25c9c5f5b535d59}{refetchRssFeeds}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00031\ \ \ \ \ \textcolor{keywordtype}{bool}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a27e3979a7d81f8b7a309461f2d4a8b68}{addUrl}}(\textcolor{keyword}{const}\ std::string\ \&url,\ \textcolor{keywordtype}{bool}\ embedded,\ uint64\_t\ discordChannelId\ =\ 0)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00032\ \ \ \ \ [[nodiscard]]\ std::string\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_af81ee0debcf70c8e879fa5a1934815e8}{listUrlsAsString}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00033\ \ \ \ \ [[nodiscard]]\ \mbox{\hyperlink{structdotnamecpp_1_1rss_1_1RSSItem}{RSSItem}}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_aca0ba13d4a29203c10adf306920632f4}{getRandomItem}}()\ \textcolor{keyword}{override};}
\DoxyCodeLine{00034\ \ \ \ \ [[nodiscard]]\ \mbox{\hyperlink{structdotnamecpp_1_1rss_1_1RSSItem}{RSSItem}}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_aaea4cb356ec1cbbb0459a31c58b40c7c}{getRandomItemMatchingEmbedded}}(\textcolor{keywordtype}{bool}\ embedded)\ \textcolor{keyword}{override};}
\DoxyCodeLine{00035\ \ \ \ \ [[nodiscard]]\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_a03d9fb244b937285a8b57d1c3d681ef6}{getItemCount}}()\textcolor{keyword}{\ const\ override\ }\{\ \textcolor{keywordflow}{return}\ feed\_.items.size();\ \}}
\DoxyCodeLine{00036\ \ \ \ \ [[nodiscard]]\ \textcolor{keywordtype}{size\_t}\ \mbox{\hyperlink{classdotnamecpp_1_1rss_1_1RssManager_aaf4027ab3775c4174fea7c1647635286}{getItemCountMatchingEmbedded}}(\textcolor{keywordtype}{bool}\ embedded)\ \textcolor{keyword}{const\ override};}
\DoxyCodeLine{00037\ }
\DoxyCodeLine{00038\ \ \ \textcolor{keyword}{private}:}
\DoxyCodeLine{00039\ \ \ \ \ \textcolor{comment}{//\ Private\ helpers}}
\DoxyCodeLine{00048\ \ \ \ \ \textcolor{keywordtype}{int}\ fetchUrlSource(\textcolor{keyword}{const}\ std::string\ \&url,\ \textcolor{keywordtype}{bool}\ embedded\ =\ \textcolor{keyword}{false},}
\DoxyCodeLine{00049\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ uint64\_t\ discordChannelId\ =\ 0);}
\DoxyCodeLine{00050\ }
\DoxyCodeLine{00057\ \ \ \ \ \textcolor{keyword}{static}\ std::string\ getItemAsMarkdown(\textcolor{keyword}{const}\ \mbox{\hyperlink{structdotnamecpp_1_1rss_1_1RSSItem}{RSSItem}}\ \&item);}
\DoxyCodeLine{00058\ }
\DoxyCodeLine{00063\ \ \ \ \ \textcolor{keywordtype}{void}\ clearFeedBuffer();}
\DoxyCodeLine{00064\ }
\DoxyCodeLine{00074\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{size\_t}\ WriteCallback(\textcolor{keywordtype}{void}\ *contents,\ \textcolor{keywordtype}{size\_t}\ size,\ \textcolor{keywordtype}{size\_t}\ nmemb,\ \textcolor{keywordtype}{void}\ *userp);}
\DoxyCodeLine{00075\ }
\DoxyCodeLine{00083\ \ \ \ \ \textcolor{keyword}{static}\ \textcolor{keywordtype}{bool}\ hasFileChanged(\textcolor{keyword}{const}\ std::filesystem::path\ \&path,}
\DoxyCodeLine{00084\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ std::filesystem::file\_time\_type\ \&lastModified);}
\DoxyCodeLine{00085\ }
\DoxyCodeLine{00092\ \ \ \ \ \textcolor{keywordtype}{bool}\ hasFilesChanged();}
\DoxyCodeLine{00093\ }
\DoxyCodeLine{00099\ \ \ \ \ \textcolor{keywordtype}{bool}\ loadUrls();}
\DoxyCodeLine{00100\ }
\DoxyCodeLine{00106\ \ \ \ \ \textcolor{keywordtype}{bool}\ loadSeenHashes();}
\DoxyCodeLine{00107\ }
\DoxyCodeLine{00113\ \ \ \ \ \textcolor{keywordtype}{bool}\ saveUrls();}
\DoxyCodeLine{00114\ }
\DoxyCodeLine{00121\ \ \ \ \ \textcolor{keywordtype}{bool}\ saveSeenHash(\textcolor{keyword}{const}\ std::string\ \&hash);}
\DoxyCodeLine{00122\ }
\DoxyCodeLine{00128\ \ \ \ \ \textcolor{keywordtype}{bool}\ saveAllSeenHashes();\ \textcolor{comment}{//\ Save\ all\ hashes\ at\ once}}
\DoxyCodeLine{00129\ }
\DoxyCodeLine{00139\ \ \ \ \ \mbox{\hyperlink{structdotnamecpp_1_1rss_1_1RSSFeed}{RSSFeed}}\ parseRSS(\textcolor{keyword}{const}\ std::string\ \&xmlData,\ \textcolor{keywordtype}{bool}\ embedded,\ uint64\_t\ discordChannelId,}
\DoxyCodeLine{00140\ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \ \textcolor{keywordtype}{int}\ \&totalDuplicateItems);}
\DoxyCodeLine{00141\ }
\DoxyCodeLine{00148\ \ \ \ \ std::string\ downloadFeed(\textcolor{keyword}{const}\ std::string\ \&url);}
\DoxyCodeLine{00149\ }
\DoxyCodeLine{00150\ \ \ \ \ \textcolor{comment}{//\ Data\ members}}
\DoxyCodeLine{00151\ \ \ \ \ \textcolor{keywordtype}{bool}\ isInitialized\_\{\textcolor{keyword}{false}\};}
\DoxyCodeLine{00152\ }
\DoxyCodeLine{00153\ \ \ \ \ std::filesystem::path\ urlsPath\_;}
\DoxyCodeLine{00154\ \ \ \ \ std::filesystem::file\_time\_type\ urlsLastModified\_;}
\DoxyCodeLine{00155\ }
\DoxyCodeLine{00156\ \ \ \ \ std::filesystem::path\ hashesPath\_;}
\DoxyCodeLine{00157\ \ \ \ \ std::filesystem::file\_time\_type\ hashesLastModified\_;}
\DoxyCodeLine{00158\ }
\DoxyCodeLine{00159\ \ \ \ \ std::mt19937\ rng\_;}
\DoxyCodeLine{00160\ \ \ \ \ std::shared\_ptr<dotnamecpp::logging::ILogger>\ logger\_;}
\DoxyCodeLine{00161\ \ \ \ \ std::shared\_ptr<dotnamecpp::assets::IAssetManager>\ assetManager\_;}
\DoxyCodeLine{00162\ \ \ \ \ RSSFeed\ feed\_;}
\DoxyCodeLine{00163\ \ \ \ \ std::vector<RSSUrl>\ urls\_;}
\DoxyCodeLine{00164\ \ \ \ \ std::unordered\_set<std::string>\ seenHashes\_;}
\DoxyCodeLine{00165\ \ \ \};}
\DoxyCodeLine{00166\ \}\ \textcolor{comment}{//\ namespace\ dotnamecpp::rss}}

\end{DoxyCode}
